schema: '2.0'
stages:
  select_themes:
    cmd: python pipeline/theme_selector.py
    deps:
    - path: ../data/categories/wiki_categories_filtered
      hash: md5
      md5: a0524ed4af03780d38e452acd528ce67
      size: 3147
    - path: pipeline/theme_selector.py
      hash: md5
      md5: b9059e201776c51203a926bbe009acec
      size: 5648
    params:
      params.yaml:
        puzzle_generation:
          total_puzzle_count: 80
          themes_per_puzzle: 4
          words_per_theme: 4
          min_similarity_threshold: 0.3
          theme_selection_method: random
          random_seed: 42
        themes:
          source: ../data/categories/wiki_categories_filtered
          exclude_categories:
          - General reference
          - Research
          - Academic disciplines
          - Library science
          min_theme_length: 3
    outs:
    - path: data/selected_themes.json
      hash: md5
      md5: d66da19c3f13a654c734d9b0d9c2e97e
      size: 5684
  generate_puzzles:
    cmd: python pipeline/puzzle_generator.py
    deps:
    - path: ../../themes_index/themes_metadata.json
      hash: md5
      md5: 0057523c15907dfe46ab51aac78b3b9a
      size: 148
    - path: ../../themes_index/themes_vectors.bin
      hash: md5
      md5: 4b3ccfe9e1ce0c8d1e099c86142e6484
      size: 1028004008
    - path: ../../themes_index/themes_vocabulary.json
      hash: md5
      md5: d1749de07cefb80a52f7e4db20afee80
      size: 9671670
    - path: data/selected_themes.json
      hash: md5
      md5: d66da19c3f13a654c734d9b0d9c2e97e
      size: 5684
    - path: pipeline/puzzle_generator.py
      hash: md5
      md5: e3e5a2e568c3c8421eeff0c261eb3f45
      size: 12037
    params:
      params.yaml:
        output:
          format: json
          include_metadata: true
          include_similarity_scores: true
          puzzle_file: data/wiki_puzzles.json
          metadata_file: data/puzzle_metadata.json
        puzzle_generation:
          total_puzzle_count: 80
          themes_per_puzzle: 4
          words_per_theme: 4
          min_similarity_threshold: 0.3
          theme_selection_method: random
          random_seed: 42
        vector_search:
          data_source: ../../themes_index
          use_lemmatized: true
          similarity_metric: cosine
          max_search_candidates: 20
    outs:
    - path: data/puzzle_metadata.json
      hash: md5
      md5: 35723fa2b176a750bd43187981cb1996
      size: 336
    - path: data/wiki_puzzles.json
      hash: md5
      md5: 6bb9aafbfb27fe0bd23969d58c08a4f1
      size: 214528
